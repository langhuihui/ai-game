extends layout

block content
  h2.mb-4
    i.bi.bi-terminal.me-2
    | SYSTEM LOGS / 系统日志
  
  .row.mb-3
    .col-md-4
      form(method="GET" action="/logs")
        input.form-control(type="date" name="date" value=selectedDate placeholder="选择日期" onchange="this.form.submit()")
    .col-md-4
      form(method="GET" action="/logs")
        select.form-select(name="character" onchange="this.form.submit()")
          option(value="" selected=!selectedCharacter) 所有角色
          each char in characters
            option(value=char selected=(char === selectedCharacter))= char
        if selectedDate
          input(type="hidden" name="date" value=selectedDate)
    .col-md-4
      a.btn.btn-primary(href="/logs")
        i.bi.bi-arrow-clockwise
        |  RESET / 重置
  
  if logs.length === 0
    p.text-muted [NO DATA] 暂无日志记录
  else
    each log in logs
      .log-entry(class=log.result ? 'success' : 'error')
        .d-flex.justify-content-between.align-items-start
          .flex-grow-1
            .d-flex.align-items-center.mb-1
              strong= `[${log.character_name || 'SYSTEM'}]`
              span.badge.bg-secondary.ms-2= log.action_type
            .text-muted.small.mb-1= log.action_data
            if log.result
              .text-success.small OUTPUT: #{log.result}
          small.text-muted= `[${new Date(log.timestamp).toLocaleString('zh-CN')}]`

